name: 'sesam-deployer-github-action'
description: 'Deploy secrets, variables, and configurations to a Sesam node.'

inputs:
  node:
    description: 'The hostname of the Sesam node where the deployment will occur. Example: "datahub-asdfasdf.sesam.cloud"'
    required: true

  jwt:
    description: 'The JWT authorization token generated by the Sesam portal.'
    required: true

  dry_run: 
    description: 'Simulate the deployment process without making actual changes. Defaults to true if not specified.'
    default: true
    required: false

  write_summary: 
    description: 'If set to true, the github action will write all logs to the GITHUB_STEP_SUMMARY'
    default: false
    required: false

  force_config:
    description: 'Whether to force the deployment of configurations even if validation fails. Valid values are "true" or "false". Defaults to false if not specified.'
    required: false
    default: false

  replace_secrets:
    description: 'Replace all existing secrets in the node with the provided secrets file. Valid values are "true" or "false". Defaults to false if not specified.'
    required: false
    default: false

  secrets_file: 
    description: 'The path to a JSON file containing secrets to be deployed.'
    required: false

  variables_file:
    description: 'The path to a JSON file containing variables to be deployed.'
    required: false

  config_folder:
    description: 'The base path where configuration files are located.'
    default: 'node/'
    required: true

  use_whitelist: 
    description: 'If set to true, reads configuration files as defined in config_root/deployment/whitelist.txt file.'
    default: false
    required: false
  
runs:
  using: 'docker'
  image: 'Dockerfile'
